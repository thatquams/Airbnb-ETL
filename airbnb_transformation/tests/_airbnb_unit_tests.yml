unit_tests:
  - name: test_is_superhost
    description: "Validates the `is_superhost` case statement"
    model: dim_host
    given:
      - input: ref('stg_airbnb_hosts')
        rows:
          - {ID: 227835898, name: Zviad, is_superhost: f}
          - {ID: 242128703, name: Zöhre, is_superhost: t}
          

    expect:
      rows:
        - {host_key: 28fe96f6032dedf13039360ad93b2d74, host_name: Zviad, superhost: N}
        - {host_key: 1f063daec380952d10778b70afd95f3b, host_name: Zöhre, superhost: Y}



#   - name: test_validate_number_of_reviews
#     description: "Validate Number of reviews"
#     model: reviews_agg
#     given:
#       - input: ref('dim_reviews')
#         rows:
#           - { sentiment: 2}
#           - { sentiment: 1}
#           - { sentiment: 0}

#     expect:
#       rows:
#         - { sentiment: 2, tot_reviews: 147640}
#         - { sentiment: 1, tot_reviews: 232554}
#         - { sentiment: 0, tot_reviews: 30090}
